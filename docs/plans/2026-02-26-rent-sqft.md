# Rent $/sqft Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Replace the single "Monthly Rent" slider with three sliders (base rent $/sqft/yr, sqft, NNN $/sqft/yr) that compute monthly rent.

**Architecture:** Remove `rent` state, add `rentPerSqft`, `sqft`, `nnnPerSqft` state vars. Compute `totalMonthlyRent = ((rentPerSqft + nnnPerSqft) * sqft) / 12` inside `useMemo`. Use `totalMonthlyRent` everywhere `rent` was used. Show derived monthly rent below the sliders.

**Tech Stack:** React 18, Vite 5, plain inline styles, no test framework.

---

### Task 1: Replace rent state with three new state vars

**Files:**
- Modify: `src/App.jsx`

**Step 1: Replace state declaration**

Find line 34:
```js
const [rent, setRent] = useState(2000);
```

Replace with:
```js
const [rentPerSqft, setRentPerSqft] = useState(25);
const [sqft, setSqft] = useState(800);
const [nnnPerSqft, setNnnPerSqft] = useState(5);
```

**Step 2: Update useMemo dependency array**

Find line 158-159:
```js
}, [simTier, rent, buildout, peakRate, offPeakRate, lateRate, peakOcc, offPeakOcc, lateOcc,
    memberPrice, memberCount, memberUtil, memberPeakPct, memberDailyHrs, rampMonths, bayCount]);
```

Replace with:
```js
}, [simTier, rentPerSqft, sqft, nnnPerSqft, buildout, peakRate, offPeakRate, lateRate, peakOcc, offPeakOcc, lateOcc,
    memberPrice, memberCount, memberUtil, memberPeakPct, memberDailyHrs, rampMonths, bayCount]);
```

**Step 3: Verify**

Run `npm run dev`. App will have a runtime error because `rent` is still referenced inside `useMemo` and in the JSX. That's expected — it will be fixed in Task 2.

**Step 4: Commit**

```bash
git add src/App.jsx
git commit -m "feat: replace rent state with rentPerSqft, sqft, nnnPerSqft"
```

---

### Task 2: Update useMemo to compute totalMonthlyRent and use it

**Files:**
- Modify: `src/App.jsx` (inside the `useMemo` block)

**Step 1: Add totalMonthlyRent computation**

At the top of the `useMemo` block, after line 61 (`const SIM_COST = ...`), add:

```js
const totalMonthlyRent = ((rentPerSqft + nnnPerSqft) * sqft) / 12;
```

**Step 2: Update expenses object**

Find inside the `expenses` object (line 91):
```js
rent: rent * bayCount,
```

Replace with:
```js
rent: totalMonthlyRent * bayCount,
```

**Step 3: Update startup leaseDeposit**

Find (line 108):
```js
leaseDeposit: rent * 3,
```

Replace with:
```js
leaseDeposit: totalMonthlyRent * 3,
```

**Step 4: Add totalMonthlyRent to useMemo return**

Find the return object starting at line 148. Add `totalMonthlyRent` to the returned values:

```js
return {
  peakRevMonth, offPeakRevMonth, lateRevMonth, hourlyRevGross, hourlyRevNet,
  membershipRev, displacedRevMonth, netMemberImpact, monthlyRev,
  memberHrsPerDay, memberHrsPerDayRaw, capped,
  expenses, totalMonthlyExp, monthlyProfit, annualProfit,
  startup, totalStartup,
  paybackMonths, blendedRate, breakEvenHrsDay, breakEvenOccPct,
  blendedOcc, totalBookedHrsDay: totalBookedHrsDay.toFixed(1),
  cashFlow, totalMonthlyRent
};
```

**Step 5: Verify**

`npm run dev`. App should load with no errors. With defaults (rentPerSqft=25, sqft=800, nnnPerSqft=5), totalMonthlyRent = ((25+5)*800)/12 = $2,000/mo — same as the old default. All numbers should be identical to before.

**Step 6: Commit**

```bash
git add src/App.jsx
git commit -m "feat: compute totalMonthlyRent from sqft inputs in useMemo"
```

---

### Task 3: Update Space & Buildout UI

**Files:**
- Modify: `src/App.jsx` (JSX return block)

**Step 1: Replace the Monthly Rent slider**

Find the `Space & Buildout` section (line 201-204):
```jsx
<Section title="Space & Buildout">
  <Slider label="Monthly Rent" value={rent} onChange={setRent} min={1000} max={8000} step={100} format={$} />
  <Slider label="Buildout Cost" value={buildout} onChange={setBuildout} min={5000} max={60000} step={1000} format={$k} />
</Section>
```

Replace with:
```jsx
<Section title="Space & Buildout">
  <Slider label="Base Rent ($/sqft/yr)" value={rentPerSqft} onChange={setRentPerSqft} min={5} max={80} step={1} format={v => `$${v}/sqft`} />
  <Slider label="Square Footage" value={sqft} onChange={setSqft} min={200} max={3000} step={50} format={v => `${v.toLocaleString()} sqft`} />
  <Slider label="NNN ($/sqft/yr)" value={nnnPerSqft} onChange={setNnnPerSqft} min={0} max={20} step={0.5} format={v => `$${v}/sqft`} />
  <div style={{ background: "#1e293b", padding: 10, borderRadius: 8, marginTop: 8 }}>
    <Row label="Monthly Rent (base + NNN)" value={$(m.totalMonthlyRent)} bold color="#f1f5f9" />
  </div>
  <Slider label="Buildout Cost" value={buildout} onChange={setBuildout} min={5000} max={60000} step={1000} format={$k} />
</Section>
```

**Step 2: Verify**

`npm run dev`. The Space & Buildout section should now show three sliders + a computed monthly rent display + the buildout slider. Adjusting any of the three rent inputs should update the monthly rent display and all financial outputs. With defaults, monthly rent shows $2,000.

**Step 3: Commit**

```bash
git add src/App.jsx
git commit -m "feat: update Space & Buildout UI with sqft-based rent sliders"
```
