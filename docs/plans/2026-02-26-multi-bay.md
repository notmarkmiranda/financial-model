# Multi-Bay Support Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Add a 1–3 bay selector that scales revenue and costs across all bays in the financial model.

**Architecture:** Single `bayCount` state variable drives all scaling. Revenue and per-bay costs multiply by `bayCount`. Shared costs (internet, software, marketing) stay flat. Insurance gets a base + per-bay formula. Startup costs split similarly. All inputs continue to describe one bay.

**Tech Stack:** React 18, Vite 5, plain inline styles (no component library, no test framework in project).

---

### Task 1: Add bayCount state

**Files:**
- Modify: `src/App.jsx`

**Step 1: Add state**

In `App()`, after the existing `useState` declarations, add:

```js
const [bayCount, setBayCount] = useState(1);
```

**Step 2: Add bayCount to useMemo dependency array**

The last line of the `useMemo` dep array currently ends with `rampMonths]`. Add `bayCount`:

```js
  [simTier, rent, buildout, peakRate, offPeakRate, lateRate, peakOcc, offPeakOcc, lateOcc,
   memberPrice, memberCount, memberUtil, memberPeakPct, memberDailyHrs, rampMonths, bayCount]
```

**Step 3: Verify**

Run `npm run dev`. App should load with no errors in the console. No visible change yet.

**Step 4: Commit**

```bash
git add src/App.jsx
git commit -m "feat: add bayCount state"
```

---

### Task 2: Scale revenue and per-bay expenses in the model

**Files:**
- Modify: `src/App.jsx` (inside the `useMemo` block)

**Step 1: Scale hourly revenue**

After the existing lines that compute `peakRevMonth`, `offPeakRevMonth`, `lateRevMonth`, and `hourlyRevGross`, multiply `hourlyRevGross` by `bayCount`:

```js
const hourlyRevGrossPerBay = peakRevMonth + offPeakRevMonth + lateRevMonth;
const hourlyRevGross = hourlyRevGrossPerBay * bayCount;
```

> Note: `peakRevMonth`, `offPeakRevMonth`, `lateRevMonth` stay as per-bay values — they're used in the revenue breakdown section of the UI.

**Step 2: Scale membership revenue and displacement**

Memberships describe one bay. Total membership rev and displacement scale by `bayCount`:

```js
const membershipRev = memberPrice * memberCount * bayCount;
// ... existing memberHrsPerDay calculations stay unchanged ...
const displacedRevMonth = (displacedPeakHrsDay * peakRate + displacedOffPeakHrsDay * offPeakRate) * DAYS * bayCount;
```

**Step 3: Scale monthly expenses**

Replace the `expenses` object:

```js
const expenses = {
  rent: rent * bayCount,
  utilities: 350 * bayCount,
  internet: 100,
  insurance: 200 + 50 * bayCount,
  software: 200,
  cleaning: 300 * bayCount,
  maintenance: 150 * bayCount,
  marketing: 300,
  misc: 200 * bayCount
};
```

**Step 4: Scale startup costs**

Replace the `startup` object:

```js
const startup = {
  simulator: SIM_COST * bayCount,
  buildout: buildout * bayCount,
  leaseDeposit: rent * 3,
  legal: 3000,
  tech: 2500,
  signage: 3000,
  launchMktg: 2000,
  contingency: 5000
};
```

**Step 5: Verify**

`npm run dev`. With bayCount=1, all numbers should be identical to before. Changing bayCount from 1 to 2 should (mentally) roughly double revenue and most costs. Check that insurance with 2 bays = $300 (200 + 50*2). Lease deposit should stay the same regardless of bay count.

**Step 6: Commit**

```bash
git add src/App.jsx
git commit -m "feat: scale revenue and costs by bayCount"
```

---

### Task 3: Add bay count selector UI

**Files:**
- Modify: `src/App.jsx` (JSX return block)

**Step 1: Add the selector section**

In the JSX, immediately before the `<Section title="Simulator Tier">` block, add:

```jsx
<Section title="Number of Bays">
  <div style={{ display: "flex", gap: 8, marginBottom: 4 }}>
    {[1, 2, 3].map(n => (
      <button key={n} onClick={() => setBayCount(n)}
        style={{
          padding: "8px 14px", borderRadius: 8,
          border: bayCount === n ? "2px solid #22c55e" : "1px solid #334155",
          background: bayCount === n ? "#14532d" : "#1e293b",
          color: bayCount === n ? "#22c55e" : "#94a3b8",
          fontSize: 13, fontWeight: 600, cursor: "pointer", flex: 1
        }}>
        {n} {n === 1 ? "Bay" : "Bays"}
      </button>
    ))}
  </div>
</Section>
```

**Step 2: Update the page subtitle**

Change the subtitle `<p>` from:

```jsx
<p style={{ fontSize: 13, color: "#64748b", marginBottom: 24 }}>1 Bay, 24-Hour Self-Serve Operation</p>
```

to:

```jsx
<p style={{ fontSize: 13, color: "#64748b", marginBottom: 24 }}>{bayCount} {bayCount === 1 ? "Bay" : "Bays"}, 24-Hour Self-Serve Operation</p>
```

**Step 3: Verify**

`npm run dev`. Toggle between 1, 2, and 3 bays. Summary cards should update. Lease deposit should remain constant. Insurance should be $250 for 1 bay, $300 for 2, $350 for 3.

**Step 4: Commit**

```bash
git add src/App.jsx
git commit -m "feat: add bay count selector UI"
```

---

### Task 4: Update revenue breakdown labels in UI

The "Monthly Revenue Breakdown" section hardcodes labels like "Peak hours (6hrs/day)". With multiple bays these should reflect total booked hours.

**Files:**
- Modify: `src/App.jsx` (JSX return block, Monthly Revenue Breakdown section)

**Step 1: Update labels to show per-bay context**

Change the three revenue breakdown rows from:

```jsx
<Row label="Peak hours (6hrs/day)" value={$(m.peakRevMonth)} />
<Row label="Off-peak hours (11hrs/day)" value={$(m.offPeakRevMonth)} />
<Row label="Late night hours (7hrs/day)" value={$(m.lateRevMonth)} />
```

to:

```jsx
<Row label={`Peak hours (6hrs/day${bayCount > 1 ? ` × ${bayCount} bays` : ""})`} value={$(m.peakRevMonth * bayCount)} />
<Row label={`Off-peak hours (11hrs/day${bayCount > 1 ? ` × ${bayCount} bays` : ""})`} value={$(m.offPeakRevMonth * bayCount)} />
<Row label={`Late night hours (7hrs/day${bayCount > 1 ? ` × ${bayCount} bays` : ""})`} value={$(m.lateRevMonth * bayCount)} />
```

> Note: `m.peakRevMonth` etc. are still stored as per-bay values in the memo return. We display the scaled total here.

**Step 2: Verify**

With 1 bay — labels show no "× bays" suffix, numbers unchanged. With 2 bays — labels show "× 2 bays", numbers are doubled vs 1-bay scenario at same settings.

**Step 3: Commit**

```bash
git add src/App.jsx
git commit -m "feat: update revenue breakdown labels for multi-bay"
```
